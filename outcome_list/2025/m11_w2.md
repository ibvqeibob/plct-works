# Sail RISC-V C 模型编译环境搭建

## 1. 环境说明

本笔记记录在 Linux 下从源码编译 Sail RISC-V C 模型的基本流程，方便自己以后重复搭建。

- 操作系统：以 Ubuntu 22.04 x86_64 为例
- 主要工具：`git`、`gcc`、`make`、`opam` / `ocaml`
- 目标：从源码生成 RISC-V 的 C 模型，并能跑简单的 ELF 程序做验证

---

## 2. 基础依赖安装

在 Ubuntu 上安装常用的编译工具和 OCaml 环境：

    sudo apt update
    sudo apt install -y \
        git build-essential pkg-config \
        opam m4 zlib1g-dev libgmp-dev \
        python3 python3-pip

初始化 opam / OCaml（版本可以根据项目要求调整）：

    opam init -y --bare
    eval $(opam env)

    opam switch create 4.14.2
    eval $(opam env)

安装 Sail 相关的 OCaml 依赖：

    opam install -y sail zarith menhir yojson

---

## 3. 获取源码并编译 C 模型

### 3.1 克隆 Sail RISC-V 仓库

    git clone https://github.com/rems-project/sail-riscv.git
    cd sail-riscv

### 3.2 生成并编译 C 模型

使用项目提供的 Makefile / 脚本，一般可以一条命令完成 “Sail -> C -> 可执行文件”：

    make
---

## 4. 运行验证

编译成功后，一般会在当前目录或 `build/` 目录下生成 C 模型可执行程序（例如 `riscv_sim`）。  
用一个简单 ELF 程序做测试：

    ./riscv_sim path/to/hello.elf
